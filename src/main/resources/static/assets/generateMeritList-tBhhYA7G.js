import{a as m}from"./axios-G2rPRu76.js";import{_ as R,X as x,r as V,Y as c,c as L,b as s,w as p,o as z,u as r,a2 as j}from"./index-K1XzZ2A_.js";import{V as w,a as C}from"./VRow-Qf5i2-nC.js";import{V as B}from"./VSelect-L6EK_6il.js";import{V as $}from"./VTextField-ENGoE4tP.js";import{V as y}from"./VDataTable-NmoHvIyq.js";/* empty css              */import"./form-PwF12j7b.js";import"./forwardRefs-y8pOSn8h.js";import"./VMenu-YZxeOGwf.js";import"./index-3OtdKGzE.js";import"./ssrBoot-7VnEo6SR.js";import"./VImg-W4g71V9b.js";import"./VAvatar-HVdCToNH.js";import"./VDivider-7yUbEkf7.js";import"./VOverlay-hefUuoVK.js";import"./easing-imumzmxr.js";import"./lazy-5pnrxZ6V.js";import"./VCheckboxBtn-FVKGWhfF.js";import"./VField-yoownQBA.js";import"./VChip-v5paaWLz.js";import"./VTable-5Cv70kbJ.js";const N={__name:"generateMeritList",setup(E){const b=x(),e=V({data:[],headers:[],search:""});let u=window.location.protocol+"//"+window.location.hostname+":8080",n=b.currentRoute.value.query.exam,d=b.currentRoute.value.query.stage,S=[],v=[],h=[],f=[],A=[];const i=new Map;m.get(u+"/api/v1/subjectSelection/availableSubjects",{headers:{Authorization:c.get("Authorization")}}).then(t=>{console.log(t),A=t.data,A.forEach(a=>{i.set(a.subjectCode,{subjectName:a.subjectName,subjectRep:a.subjectRep})}),console.log(i),console.log(i.get(101))}),m.get(u+`/api/v1/meritList/generate/${n}/${d}`,{headers:{"Content-Type":"application/json",Authorization:c.get("Authorization")}}).then(t=>{console.log(t);let a=t.data;S=a,e.value.data=a,e.value.headers=[{title:"Overall Pos",value:"classRank"},{title:"Stream",value:"stream"},{title:"Stream Pos",value:"streamRank"},{title:"Adm No",value:"admNo"},{title:"Student Name",value:"studentName"}],i.forEach((o,g)=>{e.value.headers.push({title:i.get(g).subjectRep,value:"subjectMarks."+g}),e.value.headers.push({title:"G",value:"subjectGrades."+g})}),e.value.headers.push({title:"Aggr Points",value:"points"}),e.value.headers.push({title:"Aggr Grade",value:"aggregateGrade"}),e.value.headers.push({title:"Entry Marks",value:"kcpeMarks"}),console.log(e.value.headers)}).catch(t=>{console.log(t),(t.response&&t.response.status===401||t.response.status===403)&&window.open("/login","_blank")});let _="";const l=V({selectedStream:"All"}),k=()=>{if(e.value.data=[],l.value.selectedStream=="All"){e.value.data=S;return}if(l.value.selectedStream=="A"&&v.length>0){e.value.data=v;return}if(l.value.selectedStream=="B"&&h.length>0){e.value.data=h;return}if(l.value.selectedStream=="C"&&f.length>0){e.value.data=f;return}m.get(u+`/api/v1/meritList/viewMerit/${n}/${d}?stream=${l.value.selectedStream}`,{headers:{"Content-Type":"application/json",Authorization:c.get("Authorization")}}).then(t=>{e.value.data=t.data,l.value.selectedStream=="A"&&(v=t.data),l.value.selectedStream=="B"&&(h=t.data),l.value.selectedStream=="C"&&(f=t.data)})},M=()=>{m.get(u+`/api/v1/meritList/printMerit/${n}/${d}?stream=${l.value.selectedStream}`,{responseType:"blob",headers:{Authorization:c.get("Authorization")}}).then(t=>{const a=new Blob([t.data],{type:"application/pdf"}),o=document.createElement("a");o.href=URL.createObjectURL(a),o.download=d+l.value.selectedStream+n+" MeritList.pdf",document.body.appendChild(o),o.click(),document.body.removeChild(o)})};return(t,a)=>(z(),L("div",null,[s(w,null,{default:p(()=>[s(C,null,{default:p(()=>[s(B,{label:"Select Stream ",items:["All","A","B","C"],modelValue:r(l).selectedStream,"onUpdate:modelValue":a[0]||(a[0]=o=>r(l).selectedStream=o)},null,8,["modelValue"])]),_:1}),s(C,null,{default:p(()=>[s(j,{text:"Fetch Stream MeritList",onClick:k})]),_:1}),s(j,{text:"Download",onClick:M})]),_:1}),s(w,null,{default:p(()=>[s($,{modelValue:r(e).search,"onUpdate:modelValue":a[1]||(a[1]=o=>r(e).search=o),label:"Search",onInput:r(_)},null,8,["modelValue","onInput"]),s(y,{items:r(e).data,class:"elevation-1 custom-table",striped:"",search:r(e).search,headers:r(e).headers},null,8,["items","search","headers"])]),_:1})]))}},se=R(N,[["__scopeId","data-v-87ff8f8e"]]);export{se as default};
