import{a as c}from"./axios-G2rPRu76.js";import{_,X as R,r as w,Y as p,c as x,b as o,w as v,o as L,u as r,a2 as A}from"./index-K1XzZ2A_.js";import{V as j,a as V}from"./VRow-Qf5i2-nC.js";import{V as N}from"./VSelect-L6EK_6il.js";import{V as z}from"./VTextField-ENGoE4tP.js";import{V as B}from"./VDataTable-NmoHvIyq.js";/* empty css              */import"./form-PwF12j7b.js";import"./forwardRefs-y8pOSn8h.js";import"./VMenu-YZxeOGwf.js";import"./index-3OtdKGzE.js";import"./ssrBoot-7VnEo6SR.js";import"./VImg-W4g71V9b.js";import"./VAvatar-HVdCToNH.js";import"./VDivider-7yUbEkf7.js";import"./VOverlay-hefUuoVK.js";import"./easing-imumzmxr.js";import"./lazy-5pnrxZ6V.js";import"./VCheckboxBtn-FVKGWhfF.js";import"./VField-yoownQBA.js";import"./VChip-v5paaWLz.js";import"./VTable-5Cv70kbJ.js";const $={__name:"viewMeritList",setup(G){const f=R(),e=w({data:[],headers:[],search:""});let n=window.location.protocol+"//"+window.location.hostname+":8080",d=f.currentRoute.value.query.exam,m=f.currentRoute.value.query.stage,k=[],h=[],g=[],b=[],S=[];const i=new Map;c.get(n+"/api/v1/subjectSelection/availableSubjects",{headers:{Authorization:p.get("Authorization")}}).then(t=>{console.log(t),S=t.data,S.forEach(a=>{i.set(a.subjectCode,{subjectName:a.subjectName,subjectRep:a.subjectRep})}),console.log(i),console.log(i.get(101))}),c.get(n+`/api/v1/meritList/viewMerit/${d}/${m}`,{headers:{"Content-Type":"application/json",Authorization:p.get("Authorization")}}).then(t=>{console.log(t);let a=t.data;k=a,e.value.data=a,e.value.headers=[{title:"Overall Pos",value:"classRank",key:"classRank"},{title:"Stream",value:"stream",key:"stream"},{title:"Stream Pos",value:"streamRank",key:"streamRank"},{title:"Adm No",value:"admNo",key:"admNo"},{title:"Student Name",value:"studentName",key:"studentName"}],i.forEach((s,u)=>{e.value.headers.push({title:i.get(u).subjectRep,value:"subjectMarks."+u,key:"subjectMarks."+u}),e.value.headers.push({title:"G",value:"subjectGrades."+u,key:"subjectGrades."+u})}),e.value.headers.push({title:"Aggr Points",value:"points",key:"points"}),e.value.headers.push({title:"Aggr Grade",value:"aggregateGrade",key:"aggregateGrade"}),e.value.headers.push({title:"Entry Marks",value:"kcpeMarks",key:"kcpeMarks"}),console.log(e.value.headers)}).catch(t=>{console.log(t),(t.response&&t.response.status===401||t.response.status===403)&&window.open("/login","_blank")});let y="";const l=w({selectedStream:"All"}),M=()=>{if(e.value.data=[],l.value.selectedStream=="All"){e.value.data=k;return}if(l.value.selectedStream=="A"&&h.length>0){e.value.data=h;return}if(l.value.selectedStream=="B"&&g.length>0){e.value.data=g;return}if(l.value.selectedStream=="C"&&b.length>0){e.value.data=b;return}c.get(n+`/api/v1/meritList/viewMerit/${d}/${m}?stream=${l.value.selectedStream}`,{headers:{"Content-Type":"application/json",Authorization:p.get("Authorization")}}).then(t=>{e.value.data=t.data,l.value.selectedStream=="A"&&(h=t.data),l.value.selectedStream=="B"&&(g=t.data),l.value.selectedStream=="C"&&(b=t.data)})},C=()=>{c.get(n+`/api/v1/meritList/printMerit/${d}/${m}?stream=${l.value.selectedStream}`,{responseType:"blob",headers:{Authorization:p.get("Authorization")}}).then(t=>{const a=new Blob([t.data],{type:"application/pdf"}),s=document.createElement("a");s.href=URL.createObjectURL(a),s.download=m+l.value.selectedStream+d+" MeritList.pdf",document.body.appendChild(s),s.click(),document.body.removeChild(s)})};return(t,a)=>(L(),x("div",null,[o(j,null,{default:v(()=>[o(V,null,{default:v(()=>[o(N,{label:"Select Stream ",items:["All","A","B","C"],modelValue:r(l).selectedStream,"onUpdate:modelValue":a[0]||(a[0]=s=>r(l).selectedStream=s)},null,8,["modelValue"])]),_:1}),o(V,null,{default:v(()=>[o(A,{text:"Fetch Stream MeritList",onClick:M})]),_:1}),o(A,{text:"Download",onClick:C})]),_:1}),o(j,null,{default:v(()=>[o(z,{modelValue:r(e).search,"onUpdate:modelValue":a[1]||(a[1]=s=>r(e).search=s),label:"Search",onInput:r(y)},null,8,["modelValue","onInput"]),o(B,{items:r(e).data,class:"elevation-1 custom-table",striped:"",search:r(e).search,headers:r(e).headers},null,8,["items","search","headers"])]),_:1})]))}},oe=_($,[["__scopeId","data-v-d08b2787"]]);export{oe as default};
