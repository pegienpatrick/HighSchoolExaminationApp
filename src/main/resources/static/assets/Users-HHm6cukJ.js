import{a as g}from"./axios-G2rPRu76.js";import{r as d,Q as $,l as C,m as e,R as U,o as v,n as t,b as s,u as o,a2 as V,t as m,a as i,c as N,a4 as b,F as D,i as E}from"./index-Cp0a3j5Z.js";import{s as _}from"./sweetalert2.all-PSZh9BpD.js";import{V as F}from"./VContainer-rlvsASKg.js";import{a as S,V as q}from"./VRow-e59EUwGS.js";import{a as k,b as y,V as w,d as G}from"./VCard-f1nee6yo.js";import{V as O}from"./VTextField-74eHDJAa.js";import{V as P}from"./VDataTable-wuuS0jak.js";import{a as I,V as L}from"./VChip-8MtU5gPv.js";import{V as Q}from"./VSpacer-m-kjo5WO.js";import{V as j}from"./VDialog-xBvQGnoj.js";/* empty css              */import"./VAvatar-MKe1hS_I.js";import"./VImg-xuUNPkdI.js";import"./VField-thFyAEi-.js";import"./index-ogFRjp9r.js";import"./form-xXdqDCjs.js";import"./VLabel-X25Up-Eg.js";import"./easing-Apq16fr0.js";import"./forwardRefs-y8pOSn8h.js";import"./VSelect-Jx7iHon2.js";import"./VMenu-RzLdOBfR.js";import"./ssrBoot-DBy9na19.js";import"./VDivider-t6YFHrqH.js";import"./VOverlay-x4J7jcA1.js";import"./lazy-Pl5wsFII.js";import"./dialog-transition-VPrIJniv.js";import"./VCheckboxBtn-z-5o5nyt.js";import"./VTable-Tng2Nuci.js";const H=i("strong",null,"Username:",-1),J=i("strong",null,"Email:",-1),K=i("strong",null,"Phone:",-1),M=i("strong",null,"User Type:",-1),W=i("strong",null,"Authorization:",-1),X=i("h4",null,"Roles:",-1),Te={__name:"Users",setup(Y){const c=d({data:[],search:""}),x=d([{title:"Num",value:"num"},{title:"Username",value:"username"},{title:"Full Name",value:"fname"},{title:"Gender",value:"gender"},{title:"Email",value:"email"},{title:"Phone",value:"phone"},{title:"Authorization",value:"authorization"},{title:"User Type",value:"userType"},{title:"Roles",value:"roles"},{title:"Actions",value:"actions",sortable:!1}]),R=$();let z=window.location.protocol+"//"+window.location.hostname+":8080";R.currentRoute.value.query.examinationId,d({data:[]}),(()=>{g.get(z+"/api/v1/user/listUsers",{headers:{Authorization:U.get("Authorization")}}).then(r=>{console.log(r),c.value.data=r.data})})();const u=d(!1),a=d(null);d(null);const T=r=>{a.value=r,u.value=!0},B=()=>{let r=a.value,l=a.value.authorization=="Authorized";u.value=!1,_.fire({title:l?"Revoke Authorization?":"Authorize User?",text:l?`Are you sure you want to revoke authorization for ${r.fname}?`:`Are you sure you want to authorize ${r.fname}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:l?"Revoke":"Authorize"}).then(n=>{if(n.isConfirmed){const p=l?`/api/v1/user/deAuthorizeUser/${r.num}`:`/api/v1/user/authorizeUser/${r.num}`;g.get(z+p,{headers:{Authorization:U.get("Authorization")}}).then(h=>{_.fire({title:"Success",text:h.data.message||"Operation successful.",icon:"success"}).then(f=>{u.value=!0}),r.authorization=l?"Not Authorized":"Authorized"}).catch(h=>{var f,A;_.fire({title:"Error",text:((A=(f=h.response)==null?void 0:f.data)==null?void 0:A.message)||"An error occurred while processing your request.",icon:"error"})})}else u.value=!0})};return(r,l)=>(v(),C(F,null,{default:e(()=>[t(q,null,{default:e(()=>[t(S,null,{default:e(()=>[t(k,null,{default:e(()=>[t(y,null,{default:e(()=>[s("All Users")]),_:1}),t(w,null,{default:e(()=>[t(O,{label:"Search",modelValue:o(c).search,"onUpdate:modelValue":l[0]||(l[0]=n=>o(c).search=n)},null,8,["modelValue"]),t(P,{items:o(c).data,headers:o(x),"item-value":"num",class:"elevation-1",search:o(c).search},{"item.actions":e(({item:n})=>[t(V,{color:"primary",outlined:"",onClick:p=>T(n)},{default:e(()=>[s(" Open User ")]),_:2},1032,["onClick"])]),_:1},8,["items","headers","search"])]),_:1})]),_:1})]),_:1})]),_:1}),t(j,{modelValue:o(u),"onUpdate:modelValue":l[2]||(l[2]=n=>E(u)?u.value=n:null),"max-width":"600px"},{default:e(()=>[t(k,null,{default:e(()=>[t(y,{class:"headline"},{default:e(()=>[s(m(o(a).fname||"User Details"),1)]),_:1}),t(w,null,{default:e(()=>[i("p",null,[H,s(" "+m(o(a).username),1)]),i("p",null,[J,s(" "+m(o(a).email),1)]),i("p",null,[K,s(" "+m(o(a).phone),1)]),i("p",null,[M,s(" "+m(o(a).userType),1)]),i("p",null,[W,s(" "+m(o(a).authorization),1)]),X,t(I,{column:""},{default:e(()=>[(v(!0),N(D,null,b(o(a).roles,(n,p)=>(v(),C(L,{key:p,color:"primary",close:"","onClick:close":h=>r.removeRole(p)},{default:e(()=>[s(m(n),1)]),_:2},1032,["onClick:close"]))),128))]),_:1})]),_:1}),t(G,{class:"text-center"},{default:e(()=>[t(V,{color:"error",outlined:"",onClick:l[1]||(l[1]=n=>u.value=!1)},{default:e(()=>[s("Close")]),_:1}),t(Q),t(V,{color:o(a).authorization==="Authorized"?"success":"primary",outlined:"",onClick:B,variant:"outlined"},{default:e(()=>[s(m(o(a).authorization==="Authorized"?"Revoke Authorization":"Authorize User"),1)]),_:1},8,["color"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{Te as default};
