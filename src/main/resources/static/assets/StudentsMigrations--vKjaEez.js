import{r as m,Q as y,c as v,a as M,n as t,m as e,u as n,F as _,R as f,o as g,a2 as h,a3 as x,b as p,a4 as z,l as S}from"./index-Cp0a3j5Z.js";import{a as V}from"./axios-G2rPRu76.js";import{s as N}from"./sweetalert2.all-PSZh9BpD.js";import{V as s,a as u}from"./VRow-e59EUwGS.js";import{V as $}from"./VDialog-xBvQGnoj.js";import{a as C,b,V as U}from"./VCard-f1nee6yo.js";import{V as T}from"./VTextField-74eHDJAa.js";import{V as D}from"./VDataTable-wuuS0jak.js";import{V as R}from"./VForm-vHiLR6LN.js";import{V as O}from"./VCheckbox-XJAyhic4.js";/* empty css              */import"./VOverlay-x4J7jcA1.js";import"./easing-Apq16fr0.js";import"./lazy-Pl5wsFII.js";import"./VImg-xuUNPkdI.js";import"./forwardRefs-y8pOSn8h.js";import"./dialog-transition-VPrIJniv.js";import"./VAvatar-MKe1hS_I.js";import"./VField-thFyAEi-.js";import"./index-ogFRjp9r.js";import"./form-xXdqDCjs.js";import"./VLabel-X25Up-Eg.js";import"./VSelect-Jx7iHon2.js";import"./VMenu-RzLdOBfR.js";import"./ssrBoot-DBy9na19.js";import"./VDivider-t6YFHrqH.js";import"./VCheckboxBtn-z-5o5nyt.js";import"./VChip-8MtU5gPv.js";import"./VTable-Tng2Nuci.js";const gt={__name:"StudentsMigrations",setup(Y){const r=m({data:[],search:""}),i=m({stages:[],title:new Date().getFullYear()+" Migrations",show:!1,sel:{}}),k=m([{title:"Uid",value:"uid"},{title:"Title",value:"title"},{title:"Made On",value:"doneOn"},{title:"Classes",value:"classes"},{title:"Action",value:"actions"}]);y();let w=window.location.protocol+"//"+window.location.hostname+":8080";m({data:[]});let A=["1","2","3","4"];const c=()=>{V.get(w+"/api/v1/studentsMigration/listMigrations",{headers:{Authorization:f.get("Authorization")}}).then(o=>{console.log(o.data),r.value.data=o.data})};c();const B=()=>{i.value.show=!1,i.value.stages=[];for(const o in i.value.sel)i.value.sel[o]&&i.value.stages.push(o);V.post(w+"/api/v1/studentsMigration/migrateStudents",i.value,{headers:{Authorization:f.get("Authorization")}}).then(o=>{console.log(o),c()}).catch(o=>{console.log(o);var l="";o.response.data,l=o.response.data,alert("error "+l)})},F=o=>{console.log(o.uid),N.fire({title:"Undo Migration",text:"Are you sure you want to Undo This Migration ? ",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"}).then(l=>{if(l.isConfirmed){const a=window.location.protocol+"//"+window.location.hostname+":8080";V.delete(a+`/api/v1/studentsMigration/undoMigration/${o.uid}`,{headers:{Authorization:f.get("Authorization")}}).then(d=>{console.log(d),c()})}})};return(o,l)=>(g(),v(_,null,[M("div",null,[t(s,null,{default:e(()=>[t(u,null,{default:e(()=>[t(h,{text:"New Students Migration","prepend-icon":"ri-add-circle-line",onClick:l[0]||(l[0]=x(a=>n(i).show=!0,["prevent"]))})]),_:1})]),_:1}),t(s,null,{default:e(()=>[t(u,null,{default:e(()=>[t(C,null,{default:e(()=>[t(b,null,{default:e(()=>[p("All migrations")]),_:1}),t(U,null,{default:e(()=>[t(T,{label:"Search",modelValue:n(r).search,"onUpdate:modelValue":l[1]||(l[1]=a=>n(r).search=a)},null,8,["modelValue"]),t(D,{items:n(r).data,search:n(r).search,headers:n(k),class:"elevation-1"},{"item.actions":e(({item:a})=>[t(h,{color:"error",outlined:"",onClick:d=>F(a)},{default:e(()=>[p(" Undo Migration ")]),_:2},1032,["onClick"])]),_:2},1032,["items","search","headers"])]),_:1})]),_:1})]),_:1})]),_:1})]),t($,{modelValue:n(i).show,"onUpdate:modelValue":l[3]||(l[3]=a=>n(i).show=a),"max-width":"600px",class:"d-flex bg-white text-center"},{default:e(()=>[t(C,null,{default:e(()=>[t(b,{class:"text-h6 font-weight-bold"},{default:e(()=>[p("Create Migration")]),_:1}),t(U,{"align-center":""},{default:e(()=>[t(R,{onSubmit:x(B,["prevent"])},{default:e(()=>[t(s,null,{default:e(()=>[t(u,{md:"12",cols:"12"},{default:e(()=>[t(T,{placeholder:"Migration Title (e.g. 2025 Migration)",label:"Migration Title (e.g. 2025 Migration)",type:"text",required:"",modelValue:n(i).title,"onUpdate:modelValue":l[2]||(l[2]=a=>n(i).title=a)},null,8,["modelValue"])]),_:1})]),_:1}),t(s,null,{default:e(()=>[t(u,{md:"9",cols:"12"},{default:e(()=>[M("div",null,[(g(!0),v(_,null,z(n(A),a=>(g(),S(O,{key:a,label:`Form ${a}`,modelValue:n(i).sel[a],"onUpdate:modelValue":d=>n(i).sel[a]=d},null,8,["label","modelValue","onUpdate:modelValue"]))),128))])]),_:1})]),_:1}),t(s,null,{default:e(()=>[t(u,null,{default:e(()=>[t(h,{color:"primary",type:"submit"},{default:e(()=>[p(" Complete Migration ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{gt as default};
