import{a as D}from"./axios-G2rPRu76.js";import{_ as B,Q as S,r as p,ac as z,l as y,m as t,a5 as I,R as k,o as g,n as e,b as n,c as R,a,t as u,a2 as x,V as A,Z as w,ad as T}from"./index-Cp0a3j5Z.js";import{V as c,a as l}from"./VRow-e59EUwGS.js";import{a as b,b as E,V as v,c as F}from"./VCard-f1nee6yo.js";import{V as P}from"./VAlert-bEwvtgot.js";import{V as q}from"./VContainer-rlvsASKg.js";/* empty css              */import"./VAvatar-MKe1hS_I.js";import"./VImg-xuUNPkdI.js";S();const L={setup(){const s=p({admNo:""}),f=p(""),_=p(""),o=p({data:"",title:"",progres:1});p(null);const m=S(),V=()=>{m.go(-1)},C=()=>{const U=window.location.protocol+"//"+window.location.hostname+":8080";f.value=m.currentRoute.value.query.admNo,_.value=m.currentRoute.value.query.examinationId,D.get(U+`/api/v1/student/viewStudent/${f.value}`,{headers:{Authorization:k.get("Authorization")}}).then(r=>{s.value=r.data.body}).catch(r=>{console.error("Error fetching student details:",r),r.response&&(r.response.status===401||r.response.status===403)&&window.open("/login","_blank")})},N=()=>{const r=window.location.protocol+"//"+window.location.hostname+":8080"+`/api/v1/reportCard/viewReportCard/${_.value}/${f.value}`;D.get(r,{responseType:"blob",headers:{Authorization:k.get("Authorization")},onDownloadProgress:d=>{const h=Math.round(d.loaded*100/d.total);console.log(`Download progress: ${h}%`),o.value.progres=h}}).then(d=>{const h=new Blob([d.data],{type:"application/pdf"}),i=document.createElement("a");i.href=URL.createObjectURL(h),i.download=s.value.admNo+s.value.name+_+" Report Card.pdf",document.body.appendChild(i),document.body.removeChild(i),o.value.data=i.href,o.value.title=i.download}).catch(d=>{console.error("Error fetching PDF:",d)})};return z(()=>{C(),N()}),{studentDetails:s,admNo:f,examinationId:_,pdfUrl:o,fetchStudentDetails:C,loadPdf:N,searchAgain:V}}},M={key:0},O=a("strong",null,"Admission Number:",-1),j=a("strong",null,"Admission Number:",-1),Q=a("strong",null,"Surname:",-1),Z=a("strong",null,"First Name:",-1),G=a("strong",null,"Other Name:",-1),H=["download","href"],J={key:0,class:"progress"},K=["src","title"];function W(s,f,_,o,m,V){return g(),y(I,null,{default:t(()=>[e(q,null,{default:t(()=>[e(c,null,{default:t(()=>[e(l,{cols:"12"},{default:t(()=>[e(b,{elevation:"3"},{default:t(()=>[e(E,{class:"text-h6 font-weight-bold"},{default:t(()=>[n("Student Report Card")]),_:1}),e(v,null,{default:t(()=>[e(l,{cols:"12"},{default:t(()=>[e(b,{title:"Student Details"},{default:t(()=>[e(v,{class:"d-flex"},{default:t(()=>[o.studentDetails==null?(g(),R("div",M,[e(c,{class:"w-100 d-block"},{default:t(()=>[e(l,null,{default:t(()=>[e(l,null,{default:t(()=>[a("p",null,[O,n(" "+u(this.admNo),1)])]),_:1})]),_:1})]),_:1}),e(c,{class:"w-100 d-block"},{default:t(()=>[e(l,null,{default:t(()=>[e(P,null,{default:t(()=>[n(" Record Not Found ")]),_:1})]),_:1})]),_:1}),e(c,null,{default:t(()=>[e(l,null,{default:t(()=>[e(x,{onClick:o.searchAgain},{default:t(()=>[e(A,{icon:"ri-restart-line"}),n(" Search Again ")]),_:1},8,["onClick"])]),_:1})]),_:1})])):w("",!0),o.studentDetails!=null?(g(),y(c,{key:1},{default:t(()=>[e(l,{md:"6",cols:"12"},{default:t(()=>[a("p",null,[j,n(" "+u(o.studentDetails.admNo),1)])]),_:1}),e(l,{md:"6",cols:"12"},{default:t(()=>[a("p",null,[Q,n(" "+u(o.studentDetails.surname),1)])]),_:1}),e(l,{md:"6",cols:"12"},{default:t(()=>[a("p",null,[Z,n(" "+u(o.studentDetails.firstName),1)])]),_:1}),e(l,{md:"6",cols:"12"},{default:t(()=>[a("p",null,[G,n(" "+u(o.studentDetails.otherName),1)])]),_:1})]),_:1})):w("",!0)]),_:1}),a("a",{class:"btn btn-primary",color:"success",download:o.pdfUrl.title,href:o.pdfUrl.data},[e(x,{text:"Download",loading:o.pdfUrl.progres>0&&o.pdfUrl.progres<100},{default:t(()=>[n(" Download _ "),e(A,{icon:"ri-download-line"})]),_:1},8,["loading"])],8,H)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(c,null,{default:t(()=>[e(l,null,{default:t(()=>[e(b,null,{default:t(()=>[e(F,null,{default:t(()=>[o.pdfUrl.progres>0&&o.pdfUrl.progres<100?(g(),R("div",J,[a("div",{class:"progress-bar",role:"progressbar",style:T({width:s.progres+"%"})},u(o.pdfUrl.progres)+"% ",5)])):w("",!0)]),_:1}),e(v,null,{default:t(()=>[a("iframe",{src:o.pdfUrl.data,width:"100%",height:"1000",frameborder:"0",title:o.pdfUrl.title},null,8,K)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}const rt=B(L,[["render",W]]);export{rt as default};
