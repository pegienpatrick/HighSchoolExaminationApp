import{_ as O,Q as z,r as y,c as x,a as u,n as l,m as s,u as o,F as k,R as $,o as v,a2 as b,b as _,a4 as L,t as M,a3 as P,l as q,W as Q,X as W}from"./index-Cp0a3j5Z.js";import{a as N}from"./axios-G2rPRu76.js";import{V,a as g}from"./VRow-e59EUwGS.js";import{V as X}from"./VDialog-xBvQGnoj.js";import{V as E}from"./VSelect-Jx7iHon2.js";import{V as U}from"./VTextField-74eHDJAa.js";import{V as Y}from"./VDataTable-wuuS0jak.js";import{V as G}from"./VForm-vHiLR6LN.js";import{a as H,b as J,c as K,V as Z,d as ee}from"./VCard-f1nee6yo.js";import{V as te}from"./VSpacer-m-kjo5WO.js";/* empty css              */import"./VOverlay-x4J7jcA1.js";import"./easing-Apq16fr0.js";import"./lazy-Pl5wsFII.js";import"./VImg-xuUNPkdI.js";import"./forwardRefs-y8pOSn8h.js";import"./dialog-transition-VPrIJniv.js";import"./form-xXdqDCjs.js";import"./VMenu-RzLdOBfR.js";import"./index-ogFRjp9r.js";import"./ssrBoot-DBy9na19.js";import"./VAvatar-MKe1hS_I.js";import"./VDivider-t6YFHrqH.js";import"./VCheckboxBtn-z-5o5nyt.js";import"./VLabel-X25Up-Eg.js";import"./VChip-8MtU5gPv.js";import"./VField-thFyAEi-.js";import"./VTable-Tng2Nuci.js";const p=w=>(Q("data-v-1974a68a"),w=w(),W(),w),le=["onDblclick"],ae=p(()=>u("label",null,"Auto Num",-1)),oe=p(()=>u("br",null,null,-1)),ne=p(()=>u("label",null,"Adm No",-1)),se=p(()=>u("br",null,null,-1)),re=p(()=>u("label",null,"Surname",-1)),de=p(()=>u("br",null,null,-1)),ie=p(()=>u("label",null,"FirstName",-1)),ue=p(()=>u("br",null,null,-1)),me=p(()=>u("label",null,"LastName",-1)),ce=p(()=>u("br",null,null,-1)),pe={__name:"students",setup(w){let B=z(),f=y({data:[],headers:[],search:""}),C=window.location.protocol+"//"+window.location.hostname+":8080",r=y({stage:"All",stream:"All"}),D=n=>{if(n<=0)return"";let a=new Date(n),e=String(a.getDate()).padStart(2,"0"),t=String(a.getMonth()+1).padStart(2,"0"),m=a.getFullYear();return`${e}-${t}-${m}`},S=()=>{var n="",a="";console.log(n),r.value.stage=="Alumini"?n="5":r.value.stage=="All"||(n=r.value.stage),console.log(n),r.value.stream=="All"?a="":a=r.value.stream,N.get(C+`/api/v1/student/listStudents?stage=${n}&stream=${a}`,{headers:{"Content-Type":"application/json",Authorization:$.get("Authorization")}}).then(e=>{console.log(e);let t=e.data,m=["num","reserved","guardians","name","birthcertno"];f.value.headers=Object.keys(t[0]).filter(c=>!m.includes(c));for(var i=0;i<t.length;i++)t[i].dateOfBirth=D(t[i].dateOfBirth),t[i].dateOfAdm=D(t[i].dateOfAdm),m.forEach(c=>{delete t[i][c]});f.value.data=t}).catch(e=>{f.value.data=[],console.log(e),(e.response&&e.response.status===401||e.response.status===403)&&window.open("/login","_blank")})};S();let F="",T=n=>{B.push(`/viewStudent?admNo=${n.admNo}`)},I=()=>{var n=r.value.stage,n="",a="";console.log(n),r.value.stage=="Alumini"?n="5":r.value.stage=="All"||(n=r.value.stage),console.log(n),r.value.stream=="All"?a="":a=r.value.stream,N.get(C+`/api/v1/student/exportStudents?stage=${n}&stream=${a}`,{headers:{"Content-Type":"application/json",Authorization:$.get("Authorization")},responseType:"blob"}).then(e=>{let t=e.headers["content-disposition"],m="downloaded_file.xls";if(console.log(e),t){let h=t.match(/filename="?([^"]+)"?/);h&&h[1]&&(m=h[1])}let i=new Blob([e.data],{type:e.headers["content-type"]}),c=document.createElement("a");c.href=URL.createObjectURL(i),c.download=m,document.body.appendChild(c),c.click(),document.body.removeChild(c),console.log(`File downloaded: ${m}`)}).catch(e=>{console.error("Error downloading the file:",e)})};const d=y({extraColumns:[],count:0,show:!1,data:["","","","","","","","","","","","","","","","","",""]});let R=()=>{var n="",a="";console.log(n),r.value.stage=="Alumini"?n="5":r.value.stage=="All"||(n=r.value.stage),console.log(n),r.value.stream=="All"?a="":a=r.value.stream,d.value.show=!1,d.value.extraColumns=[];for(var e=0;e<d.value.count;e++)d.value.extraColumns.push(d.value.data[e]);N.post(C+`/api/v1/student/printStudentsList?stage=${n}&stream=${a}`,d.value,{headers:{"Content-Type":"application/json",Authorization:$.get("Authorization")},responseType:"blob"}).then(t=>{let m=t.headers["content-disposition"],i="downloaded_file.xls";if(console.log(t),m){let A=m.match(/filename="?([^"]+)"?/);A&&A[1]&&(i=A[1])}let c=new Blob([t.data],{type:t.headers["content-type"]}),h=document.createElement("a");h.href=URL.createObjectURL(c),h.download=i,document.body.appendChild(h),h.click(),document.body.removeChild(h),console.log(`File downloaded: ${i}`)}).catch(t=>{console.error("Error downloading the file:",t)})};const j=()=>{console.log(d.value),d.value.show=!0};return(n,a)=>(v(),x(k,null,[u("div",null,[l(V,null,{default:s(()=>[l(g,null,{default:s(()=>[l(E,{label:"Select Stage (Form)",items:["All","1","2","3","4","Alumini"],modelValue:o(r).stage,"onUpdate:modelValue":[a[0]||(a[0]=e=>o(r).stage=e),o(S)]},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(g,null,{default:s(()=>[l(E,{label:"Select Stream ",items:["All","A","B","C"],modelValue:o(r).stream,"onUpdate:modelValue":[a[1]||(a[1]=e=>o(r).stream=e),o(S)]},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1}),l(V,{justify:"end",align:"center"},{default:s(()=>[l(g,{cols:"auto"},{default:s(()=>[l(b,{text:"","prepend-icon":"ri-file-excel-2-line",onClick:o(I)},{default:s(()=>[_(" Export To Excel ")]),_:1},8,["onClick"])]),_:1}),l(g,{cols:"auto"},{default:s(()=>[l(b,{text:"","prepend-icon":"ri-printer-line",onClick:j},{default:s(()=>[_(" Print Students List ")]),_:1})]),_:1})]),_:1}),l(V,null,{default:s(()=>[l(U,{modelValue:o(f).search,"onUpdate:modelValue":a[2]||(a[2]=e=>o(f).search=e),label:"Search",onInput:o(F)},null,8,["modelValue","onInput"]),l(Y,{items:o(f).data,class:"elevation-1 custom-table",striped:"",search:o(f).search,"items-per-page":o(r).stage=="All"?10:o(f).data.length},{item:s(({item:e})=>[u("tr",{onDblclick:t=>o(T)(e)},[(v(!0),x(k,null,L(o(f).headers,t=>(v(),x("td",{key:t.value},M(e[t]),1))),128)),u("td",null,[l(b,{onClick:t=>o(T)(e)},{default:s(()=>[_("View")]),_:2},1032,["onClick"])])],40,le)]),_:1},8,["items","search","items-per-page"])]),_:1})]),l(X,{modelValue:o(d).show,"onUpdate:modelValue":a[5]||(a[5]=e=>o(d).show=e),"max-width":"600px",class:"d-flex bg-white text-center",persistent:""},{default:s(()=>[l(G,{onSubmit:P(o(R),["prevent"])},{default:s(()=>[l(H,null,{default:s(()=>[l(J,{class:"text-h6 font-weight-bold"},{default:s(()=>[_("Print Students List")]),_:1}),l(K,null,{default:s(()=>[ae,oe,ne,se,re,de,ie,ue,me,ce]),_:1}),l(Z,{"align-center":""},{default:s(()=>[l(V,null,{default:s(()=>[l(g,{md:"12",cols:"12"},{default:s(()=>[l(U,{placeholder:"Extra Columns",label:"Extra Columns",type:"number",required:"",modelValue:o(d).count,"onUpdate:modelValue":a[3]||(a[3]=e=>o(d).count=e)},null,8,["modelValue"])]),_:1})]),_:1}),l(V,null,{default:s(()=>[(v(!0),x(k,null,L(Array.from({length:o(d).count},(e,t)=>t+1),e=>(v(),q(g,{md:"12",cols:"12",key:e},{default:s(()=>[l(U,{placeholder:`Column ${e} Name`,label:`Column ${e} Name e.g marks`,type:"text",required:"",modelValue:o(d).data[e-1],"onUpdate:modelValue":t=>o(d).data[e-1]=t},null,8,["placeholder","label","modelValue","onUpdate:modelValue"])]),_:2},1024))),128))]),_:1})]),_:1}),l(ee,{class:"text-center"},{default:s(()=>[l(b,{onClick:a[4]||(a[4]=e=>o(d).show=!1),color:"error",class:"btn btn-error bg-danger m-auto w-25",variant:"outlined"},{default:s(()=>[_("Cancel")]),_:1}),l(te,{class:"w-25"}),l(b,{text:"Print Students List",class:"m-auto w-50",variant:"outlined",type:"submit"})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["modelValue"])],64))}},Me=O(pe,[["__scopeId","data-v-1974a68a"]]);export{Me as default};
