import{_ as U,X as q,r as V,Y as k,c as m,b as l,w as o,o as c,B as p,t as f,u as n,F as D,a4 as O,Z as N,e as Y,ao as I,a3 as z,p as L,m as X,a as R}from"./index-o3g7j-pu.js";import{a as b}from"./axios-G2rPRu76.js";import{V as y,a as s}from"./VRow-6qMY-zIc.js";import{a as M,b as $,V as B}from"./VCard-Pw8zZ9F3.js";import{V as Z}from"./VForm-jkwPAz19.js";import{V as G}from"./VSelect-N7PvZ0d2.js";import{V as F}from"./VTextField-hSvIFRYb.js";import{V as H}from"./VDataTable-hpWUG5ub.js";/* empty css              */import"./VAvatar-rbGeQzgj.js";import"./VImg-FqV0TNDi.js";import"./form-ZbOCXVi8.js";import"./forwardRefs-y8pOSn8h.js";import"./VMenu-cCGLK3cW.js";import"./index-bUpWvayE.js";import"./ssrBoot-MY_GD0BE.js";import"./VDivider-sBH1Wu20.js";import"./VOverlay-AuJcsXDy.js";import"./easing-imumzmxr.js";import"./lazy-hOOnrdiR.js";import"./VCheckboxBtn-R6FB8e_f.js";import"./VTable-l_BT_Ovi.js";const J=h=>(L("data-v-87b5f8c2"),h=h(),X(),h),P=J(()=>R("p",null,[R("strong",null,"Marks")],-1)),Q={key:0},W={__name:"marksSheet",setup(h){const w=q();let v=window.location.protocol+"//"+window.location.hostname+":8080",x=w.currentRoute.value.query.exam,S=w.currentRoute.value.query.stage;const _=V({year:2024,term:"",title:""}),u=V({data:[],filtered:[],search:""});b.get(v+`/api/v1/examination/viewExamination/${x}`,{headers:{Authorization:k.get("Authorization")}}).then(t=>{_.value=t.data});const g=V({data:[]});let j=[];const d=new Map;b.get(v+"/api/v1/subjectSelection/availableSubjects",{headers:{Authorization:k.get("Authorization")}}).then(t=>{console.log(t),j=t.data,j.forEach(e=>{d.set(e.subjectCode,{subjectName:e.subjectName,subjectRep:e.subjectRep})}),console.log(d),console.log(d.get(101))}),b.get(v+`/api/v1/marks/viewMarksSheet/${x}/${S}`,{headers:{Authorization:k.get("Authorization")}}).then(t=>{console.log(t);var a=Object.keys(t.data[0]);console.log(a);for(var e=0;e<a.length-1;e++)g.value.data.push({title:a[e],value:a[e],align:"center"});for(var a=Object.keys(t.data[0].marks),e=0;e<a.length;e++)g.value.data.push({title:d.get(parseInt(a[e])).subjectName+"("+a[e]+")",value:a[e]});console.log(g.value.data),u.value.data=t.data,u.value.filtered=t.data});const T=t=>{let e=[];for(const a in t)if(a!="marks")e.push({value:t[a],key:a,type:1});else for(const r in t[a])e.push({value:t[a][r],key:r,type:2});return e},E=t=>{console.log(t),b.put(v+"/api/v1/marks/updateMarks",t,{headers:{Authorization:k.get("Authorization")}}).then(e=>{console.log(e)})},C=(t,e,a)=>{K(t,e,a)},K=(t,e,a)=>{const r=a==="up"?t-1:t+1;if(r>=0&&r<u.value.filtered.length){const i=`input[data-index="${r}"][data-column="${e}"]`,A=document.querySelector(i);A&&A.focus()}};return(t,e)=>(c(),m("div",null,[l(y,null,{default:o(()=>[l(s,null,{default:o(()=>[l(M,null,{default:o(()=>[l($,null,{default:o(()=>[p(" Exarm Information ")]),_:1}),l(B,null,{default:o(()=>[l(Z,null,{default:o(()=>[l(y,null,{default:o(()=>[l(s,{md:"6",cols:"12"},{default:o(()=>[p(f(n(_).title),1)]),_:1}),l(s,{md:"6",cols:"12"},{default:o(()=>[p(" Year : "+f(n(_).year),1)]),_:1}),l(s,{md:"6",cols:"12"},{default:o(()=>[p(" Form "+f(n(S)),1)]),_:1}),l(s,{md:"6",cols:"12"},{default:o(()=>[p(" Term "+f(n(_).term),1)]),_:1})]),_:1}),l(y,null,{default:o(()=>[l(s,null,{default:o(()=>[l(G,{label:"Stream",placeholder:"Select Stream",items:["All","A","B","C"],value:"All"})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(y,null,{default:o(()=>[l(s,null,{default:o(()=>[l(M,null,{default:o(()=>[l($,null,{default:o(()=>[P]),_:1}),l(B,null,{default:o(()=>[l(s,null,{default:o(()=>[l(F,{modelValue:n(u).search,"onUpdate:modelValue":e[0]||(e[0]=a=>n(u).search=a),label:"Search",clearable:""},null,8,["modelValue"])]),_:1}),l(H,{items:n(u).filtered,search:n(u).search,class:"elevation-1",striped:"","items-per-page":50,headers:n(g).data},{item:o(({item:a})=>[(c(),m("tr",{key:a.admNo},[(c(!0),m(D,null,O(T(a),r=>(c(),m("td",{key:r.key,align:"center",width:160,dense:"",style:{"inline-size":"2rem"}},[r.type===1?(c(),m("span",Q,f(r.value),1)):N("",!0),r.type===2?(c(),Y(F,{key:1,modelValue:r.value.marks,"onUpdate:modelValue":i=>r.value.marks=i,placeholder:n(d).get(r.value.subjectCode).subjectRep,class:"w-100 inputMarks",label:n(d).get(r.value.subjectCode).subjectRep,onChange:i=>E(r.value),onKeydown:[I(z(i=>C(a.admNo,r.key,"up"),["prevent"]),["up"]),I(z(i=>C(a.admNo,r.key,"down"),["prevent"]),["down"])],"data-index":a.admNo,"data-column":r.key},null,8,["modelValue","onUpdate:modelValue","placeholder","label","onChange","onKeydown","data-index","data-column"])):N("",!0)]))),128))]))]),_:1},8,["items","search","headers"])]),_:1})]),_:1})]),_:1})]),_:1})]))}},Ve=U(W,[["__scopeId","data-v-87b5f8c2"]]);export{Ve as default};
